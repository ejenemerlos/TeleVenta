"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}!function(API){var doc,cursor,settings,pageCount,table,FONT_ROW_RATIO=1.15,defaultStyles={cellPadding:5,fontSize:10,font:"helvetica",lineColor:200,lineWidth:.1,fontStyle:"normal",overflow:"ellipsize",fillColor:255,textColor:20,halign:"left",valign:"top",fillStyle:"F",rowHeight:20,columnWidth:"auto"},themes={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal",fillStyle:"F"},header:{textColor:255,fillColor:[41,128,185],rowHeight:23,fontStyle:"bold"},body:{},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1,fillStyle:"DF"},header:{textColor:255,fillColor:[26,188,156],rowHeight:23,fillStyle:"F",fontStyle:"bold"},body:{},alternateRow:{}},plain:{header:{fontStyle:"bold"}}},defaultOptions=function(){return{theme:"striped",styles:{},headerStyles:{},bodyStyles:{},alternateRowStyles:{},columnStyles:{},startY:!1,margin:40,pageBreak:"auto",tableWidth:"auto",createdHeaderCell:function(cell,data){},createdCell:function(cell,data){},drawHeaderRow:function(row,data){},drawRow:function(row,data){},drawHeaderCell:function(cell,data){},drawCell:function(cell,data){},beforePageContent:function(data){},afterPageContent:function(data){}}};function printRow(row,hookHandler){for(var i=0;i<table.columns.length;i++){var column=table.columns[i],cell=row.cells[column.dataKey];if(cell)applyStyles(cell.styles),cell.x=column.x,cell.y=cursor.y,cell.height=row.height,cell.width=column.width,"top"===cell.styles.valign?cell.textPos.y=cursor.y+cell.styles.cellPadding:"bottom"===cell.styles.valign?cell.textPos.y=cursor.y+row.height-cell.styles.cellPadding:cell.textPos.y=cursor.y+row.height/2,"right"===cell.styles.halign?cell.textPos.x=cell.x+cell.width-cell.styles.cellPadding:"center"===cell.styles.halign?cell.textPos.x=cell.x+cell.width/2:cell.textPos.x=cell.x+cell.styles.cellPadding,!1!==hookHandler(cell,hooksData({column,row}))&&(doc.rect(cell.x,cell.y,cell.width,cell.height,cell.styles.fillStyle),doc.autoTableText(cell.text,cell.textPos.x,cell.textPos.y,{halign:cell.styles.halign,valign:cell.styles.valign}))}cursor.y+=row.height}function applyStyles(styles){[{func:doc.setFillColor,value:styles.fillColor},{func:doc.setTextColor,value:styles.textColor},{func:doc.setFontStyle,value:styles.fontStyle},{func:doc.setDrawColor,value:styles.lineColor},{func:doc.setLineWidth,value:styles.lineWidth},{func:doc.setFont,value:styles.font},{func:doc.setFontSize,value:styles.fontSize}].forEach(function(obj){void 0!==obj.value&&(obj.value.constructor===Array?obj.func.apply(this,obj.value):obj.func(obj.value))})}function hooksData(additionalData){additionalData=additionalData||{};var data={pageCount,settings,table,cursor};for(var prop in additionalData)additionalData.hasOwnProperty(prop)&&(data[prop]=additionalData[prop]);return data}function ellipsize(text,width,styles,ellipsizeStr){if(ellipsizeStr=void 0!==ellipsizeStr?ellipsizeStr:"...",Array.isArray(text))return text.forEach(function(str,i){text[i]=ellipsize(str,width,styles,ellipsizeStr)}),text;if(width>=getStringWidth(text,styles))return text;for(;width<getStringWidth(text+ellipsizeStr,styles)&&!(text.length<2);)text=text.substring(0,text.length-1);return text.trim()+ellipsizeStr}function getStringWidth(text,styles){return applyStyles(styles),doc.getStringUnitWidth(text)*styles.fontSize}function extend(defaults){var prop,extended={};for(prop in defaults)defaults.hasOwnProperty(prop)&&(extended[prop]=defaults[prop]);for(var i=1;i<arguments.length;i++){var options=arguments[i];for(prop in options)options.hasOwnProperty(prop)&&("object"!=typeof options[prop]||Array.isArray(options[prop]),extended[prop]=options[prop])}return extended}API.autoTable=function(headers,data,options){doc=this,settings=function(userOptions){var settings=extend(defaultOptions(),userOptions);void 0!==settings.extendWidth&&(settings.tableWidth=settings.extendWidth?"auto":"wrap",console.error("Use of deprecated option: extendWidth, use tableWidth instead."));void 0!==settings.margins&&(void 0===settings.margin&&(settings.margin=settings.margins),console.error("Use of deprecated option: margins, use margin instead."));[["padding","cellPadding"],["lineHeight","rowHeight"],"fontSize","overflow"].forEach(function(o){var deprecatedOption="string"==typeof o?o:o[0],style="string"==typeof o?o:o[1];void 0!==settings[deprecatedOption]&&(void 0===settings.styles[style]&&(settings.styles[style]=settings[deprecatedOption]),console.error("Use of deprecated option: "+deprecatedOption+", use the style "+style+" instead."))});var marginSetting=settings.margin;settings.margin={},"number"==typeof marginSetting.horizontal&&(marginSetting.right=marginSetting.horizontal,marginSetting.left=marginSetting.horizontal);"number"==typeof marginSetting.vertical&&(marginSetting.top=marginSetting.vertical,marginSetting.bottom=marginSetting.vertical);return["top","right","bottom","left"].forEach(function(side,i){if("number"==typeof marginSetting)settings.margin[side]=marginSetting;else{var key=Array.isArray(marginSetting)?i:side;settings.margin[side]="number"==typeof marginSetting[key]?marginSetting[key]:40}}),settings}(options||{}),pageCount=1,cursor={y:!1===settings.startY?settings.margin.top:settings.startY};var userStyles={textColor:30,fontSize:doc.internal.getFontSize(),fontStyle:doc.internal.getFont().fontStyle};!function(inputHeaders,inputData){(table=new Table).x=settings.margin.left;var splitRegex=/\r\n|\r|\n/g,headerRow=new Row(inputHeaders);headerRow.index=-1;var themeStyles=extend(defaultStyles,themes[settings.theme].table,themes[settings.theme].header);headerRow.styles=extend(themeStyles,settings.styles,settings.headerStyles),inputHeaders.forEach(function(rawColumn,dataKey){"object"==typeof rawColumn&&(dataKey=void 0!==rawColumn.dataKey?rawColumn.dataKey:rawColumn.key),void 0!==rawColumn.width&&console.error("Use of deprecated option: column.width, use column.styles.columnWidth instead.");var col=new Column(dataKey);col.styles=settings.columnStyles[col.dataKey]||{},table.columns.push(col);var cell=new Cell;cell.raw="object"==typeof rawColumn?rawColumn.title:rawColumn,cell.styles=headerRow.styles,cell.text=""+cell.raw,cell.contentWidth=2*cell.styles.cellPadding+getStringWidth(cell.text,cell.styles),cell.text=cell.text.split(splitRegex),headerRow.cells[dataKey]=cell,settings.createdHeaderCell(cell,{column:col,row:headerRow,settings})}),table.headerRow=headerRow,inputData.forEach(function(rawRow,i){var row=new Row(rawRow),isAlternate=i%2==0,themeStyles=extend(defaultStyles,themes[settings.theme].table,isAlternate?themes[settings.theme].alternateRow:{}),userStyles=extend(settings.styles,settings.bodyStyles,isAlternate?settings.alternateRowStyles:{});row.styles=extend(themeStyles,userStyles),row.index=i,table.columns.forEach(function(column){var cell=new Cell;cell.raw=rawRow[column.dataKey],cell.styles=extend(row.styles,column.styles),cell.text=void 0!==cell.raw?""+cell.raw:"",row.cells[column.dataKey]=cell,settings.createdCell(cell,hooksData({column,row})),cell.contentWidth=2*cell.styles.cellPadding+getStringWidth(cell.text,cell.styles),cell.text=cell.text.split(splitRegex)}),table.rows.push(row)})}(headers,data),function(){var tableContentWidth=0;table.columns.forEach(function(column){column.contentWidth=table.headerRow.cells[column.dataKey].contentWidth,table.rows.forEach(function(row){var cellWidth=row.cells[column.dataKey].contentWidth;cellWidth>column.contentWidth&&(column.contentWidth=cellWidth)}),column.width=column.contentWidth,tableContentWidth+=column.contentWidth}),table.contentWidth=tableContentWidth;var maxTableWidth=doc.internal.pageSize.width-settings.margin.left-settings.margin.right,preferredTableWidth=maxTableWidth;"number"==typeof settings.tableWidth?preferredTableWidth=settings.tableWidth:"wrap"===settings.tableWidth&&(preferredTableWidth=table.contentWidth);table.width=preferredTableWidth<maxTableWidth?preferredTableWidth:maxTableWidth;var dynamicColumns=[],dynamicColumnsContentWidth=0,fairWidth=table.width/table.columns.length,staticWidth=0;table.columns.forEach(function(column){var colStyles=extend(defaultStyles,themes[settings.theme].table,settings.styles,column.styles);"wrap"===colStyles.columnWidth?column.width=column.contentWidth:"number"==typeof colStyles.columnWidth?column.width=colStyles.columnWidth:(colStyles.columnWidth,column.contentWidth<=fairWidth&&table.contentWidth>table.width?column.width=column.contentWidth:(dynamicColumns.push(column),dynamicColumnsContentWidth+=column.contentWidth,column.width=0)),staticWidth+=column.width}),function distributeWidth(dynamicColumns,staticWidth,dynamicColumnsContentWidth,fairWidth){var extraWidth=table.width-staticWidth-dynamicColumnsContentWidth;for(var i=0;i<dynamicColumns.length;i++){var col=dynamicColumns[i],ratio=col.contentWidth/dynamicColumnsContentWidth,isNoneDynamic=col.contentWidth+extraWidth*ratio<fairWidth;if(extraWidth<0&&isNoneDynamic){dynamicColumns.splice(i,1),dynamicColumnsContentWidth-=col.contentWidth,col.width=fairWidth,staticWidth+=col.width,distributeWidth(dynamicColumns,staticWidth,dynamicColumnsContentWidth,fairWidth);break}col.width=col.contentWidth+extraWidth*ratio}}(dynamicColumns,staticWidth,dynamicColumnsContentWidth,fairWidth),table.height=0,table.rows.concat(table.headerRow).forEach(function(row,i){var lineBreakCount=0,cursorX=table.x;table.columns.forEach(function(col){var cell=row.cells[col.dataKey];col.x=cursorX,applyStyles(cell.styles);var textSpace=col.width-2*cell.styles.cellPadding;"linebreak"===cell.styles.overflow?cell.text=doc.splitTextToSize(cell.text,textSpace+1,{fontSize:cell.styles.fontSize}):"ellipsize"===cell.styles.overflow?cell.text=ellipsize(cell.text,textSpace,cell.styles):"visible"===cell.styles.overflow||("hidden"===cell.styles.overflow?cell.text=ellipsize(cell.text,textSpace,cell.styles,""):"function"==typeof cell.styles.overflow?cell.text=cell.styles.overflow(cell.text,textSpace):console.error("Unrecognized overflow type: "+cell.styles.overflow));var count=Array.isArray(cell.text)?cell.text.length-1:0;count>lineBreakCount&&(lineBreakCount=count),cursorX+=col.width}),row.heightStyle=row.styles.rowHeight,row.height=row.heightStyle+lineBreakCount*row.styles.fontSize*FONT_ROW_RATIO,table.height+=row.height})}();var firstRowHeight=table.rows[0]&&"auto"===settings.pageBreak?table.rows[0].height:0,minTableBottomPos=settings.startY+settings.margin.bottom+table.headerRow.height+firstRowHeight;return"avoid"===settings.pageBreak&&(minTableBottomPos+=table.height),("always"===settings.pageBreak&&!1!==settings.startY||!1!==settings.startY&&minTableBottomPos>doc.internal.pageSize.height)&&(doc.addPage(),cursor.y=settings.margin.top),applyStyles(userStyles),settings.beforePageContent(hooksData()),!1!==settings.drawHeaderRow(table.headerRow,hooksData({row:table.headerRow}))&&printRow(table.headerRow,settings.drawHeaderCell),applyStyles(userStyles),table.rows.forEach(function(row,i){var rowHeight;rowHeight=row.height,cursor.y+rowHeight+settings.margin.bottom>=doc.internal.pageSize.height&&(settings.afterPageContent(hooksData()),doc.addPage(),pageCount++,cursor={x:settings.margin.left,y:settings.margin.top},settings.beforePageContent(hooksData()),!1!==settings.drawHeaderRow(table.headerRow,hooksData({row:table.headerRow}))&&printRow(table.headerRow,settings.drawHeaderCell)),row.y=cursor.y,!1!==settings.drawRow(row,hooksData({row}))&&printRow(row,settings.drawCell)}),settings.afterPageContent(hooksData()),applyStyles(userStyles),this},API.autoTableEndPosY=function(){return void 0===cursor||void 0===cursor.y?0:cursor.y},API.autoTableHtmlToJson=function(table){var tableRow,rowData,i,j,data=[],headers=[],header=table.rows[0];for(i=0;i<header.cells.length;i++)headers.push(void 0!==header.cells[i]?header.cells[i].textContent:"");for(i=1;i<table.rows.length;i++){for(tableRow=table.rows[i],rowData=[],j=0;j<header.cells.length;j++)rowData.push(void 0!==tableRow.cells[j]?tableRow.cells[j].textContent:"");data.push(rowData)}return{columns:headers,data,rows:data}},API.autoTableText=function(text,x,y,styles){"number"==typeof x&&"number"==typeof y||console.error("The x and y parameters are required. Missing for the text: ",text);var fontSize=doc.internal.getFontSize()/doc.internal.scaleFactor,lineHeightProportion=FONT_ROW_RATIO,splittedText=null,lineCount=1;if("middle"!==styles.valign&&"bottom"!==styles.valign&&"center"!==styles.halign&&"right"!==styles.halign||(lineCount=(splittedText="string"==typeof text?text.split(/\r\n|\r|\n/g):text).length||1),y+=fontSize*(2-lineHeightProportion),"middle"===styles.valign?y-=lineCount/2*fontSize:"bottom"===styles.valign&&(y-=lineCount*fontSize),"center"===styles.halign||"right"===styles.halign){var alignSize=fontSize;if("center"===styles.halign&&(alignSize*=.5),lineCount>=1){for(var iLine=0;iLine<splittedText.length;iLine++)doc.text(splittedText[iLine],x-doc.getStringUnitWidth(splittedText[iLine])*alignSize,y),y+=fontSize;return doc}x-=doc.getStringUnitWidth(text)*alignSize}return doc.text(text,x,y),doc}}(jsPDF.API);var Table=function Table(){_classCallCheck(this,Table),this.height=0,this.width=0,this.x=0,this.y=0,this.contentWidth=0,this.rows=[],this.columns=[],this.headerRow=null,this.settings={}},Row=function Row(raw){_classCallCheck(this,Row),this.raw=raw||{},this.index=0,this.styles={},this.cells={},this.height=0,this.y=0},Cell=function Cell(raw){_classCallCheck(this,Cell),this.raw=raw,this.styles={},this.text="",this.contentWidth=0,this.textPos={},this.height=0,this.width=0,this.x=0,this.y=0},Column=function Column(dataKey){_classCallCheck(this,Column),this.dataKey=dataKey,this.options={},this.styles={},this.contentWidth=0,this.width=0,this.x=0};